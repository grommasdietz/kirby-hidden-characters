(function(){"use strict";function l(s){if(!s)return"";const o=new DOMParser().parseFromString(`<div>${s}</div>`,"text/html").body.firstChild;function a(e,r=[]){if(e.nodeType===Node.TEXT_NODE)r.push(e);else if(e.nodeType===Node.ELEMENT_NODE&&!["SCRIPT","STYLE"].includes(e.tagName)){if(e.tagName==="BR"){const t=document.createElement("break");e.parentNode.insertBefore(t,e)}Array.from(e.childNodes).forEach(t=>a(t,r))}return r}const d=a(o);for(const e of d){const r=document.createDocumentFragment();for(const t of e.nodeValue)if(t.match(/[\s\u00A0]/)){const i=document.createElement("space");i.setAttribute("data-character",t),i.textContent=t,r.appendChild(i)}else if(t==="Â­"){const i=document.createElement("shy");i.textContent=t,r.appendChild(i)}else r.appendChild(document.createTextNode(t));e.replaceWith(r)}return o.innerHTML}window.panel.plugin("grommasdietz/hidden-characters",{use:[s=>{const c=["k-writer-input","k-textarea-input","k-text-input"];s.mixin({mounted(){c.includes(this.$options.name)&&this.$nextTick(()=>{const n=this.$el.matches(".k-text-input")?this.$el:this.$el.querySelector(".ProseMirror, .k-textarea-input-native");if(!n)return;this.$overlayEl=document.createElement("div");const o=["aria-hidden","autofocus","contenteditable","id","name","placeholder","spellcheck","tabindex"];for(const a of n.attributes)o.includes(a.name)||this.$overlayEl.setAttribute(a.name,a.value);this.$overlayEl.classList.add("gd-hidden-characters"),this.$overlayEl.setAttribute("data-tag",n.tagName.toLowerCase()),this.$overlayEl.setAttribute("aria-hidden","true"),this.$overlayEl.inert=!0,this.$overlayEl.innerHTML=l(this.value||""),n.after(this.$overlayEl)})},watch:{value(n){!c.includes(this.$options.name)||!this.$overlayEl||(this.$overlayEl.innerHTML=l(n||""))}}})}]})})();
